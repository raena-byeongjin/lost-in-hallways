using System.Collections;
using System.Collections.Generic;
using UnityEngine.UI;
using UnityEngine;

//-----------------------------------------------------------------------------------------------------------------------------------
// 부서 정보를 처리하기 위한 클래스
//-----------------------------------------------------------------------------------------------------------------------------------
public class uiDepartment : MonoBehaviour
{
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	[System.Serializable]
	public class _tagData
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		public string					id				= (null);
		public tagDepartmentStatic		appsitem		= (null);
		public tagBusiness				business		= (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		public uiIcon					make			= (null);
		public Text						output			= (null);
		public uiDepartmentInfo			info			= (null);
		
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		public RectTransform			transform		= (null);
		public objControl				control			= (null);
		public objControl				subject			= (null);
		public RectTransform			dropdown		= (null);
		public RectTransform			productLayer	= (null);
		public objControl				destroy			= (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		public float					foldHeight		= (0);
		public List<Transform>			Folds			= new List<Transform>();

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		public List<uiProduct>			Products		= new List<uiProduct>();

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	};
	protected _tagData		_data		= (null);

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected virtual void Awake()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		Initialize();

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected void Initialize( _tagData data=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		if( (data)==(null) ) return;	//(NULL)값을 허용함

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (data)!=(null) )
		{
			(_data)	= (data);
		}
		else
		{
			(_data) = new _tagData();
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(Data().transform)	= (transform as RectTransform);
		(Data().control)	= (GetComponent(typeof(objControl)) as objControl);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( ProductLayer()!=(null) && (ProductLayer().childCount)>(0) )
		{
			(Transform().sizeDelta)	= new Vector2( (Transform().sizeDelta.x), (Transform().sizeDelta.y-ProductLayer().sizeDelta.y) );
			Func.ChildsDestroy( ProductLayer() );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( Make()!=(null) && Make().Text()!=(null) )
		{
			(Make().Text().text)	= (null);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected virtual void Start()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !CApp.This.Business.IsRight(GetBusiness()) )
		{
			if( (Data().destroy)!=(null) )
			{
				Data().destroy.OFF();
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 트랜스 폼을 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public RectTransform Transform()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().transform);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 컨트롤 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public objControl Control()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().control);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 제목 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public objControl Subject()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().subject);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 클릭에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public virtual void OnClick()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// ID를 설정하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void SetID( string id )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (id)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(Data().id)	= (id);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 부서 정보를 입력하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Set( tagDepartmentStatic appsitem )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (appsitem)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(Data().appsitem)	= (appsitem);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 사업체를 설정하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Set( tagBusiness business )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (business)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(Data().business)	= (business);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 부서 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagDepartmentStatic Get()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().appsitem);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 부서를 폐쇄하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	void funcDestroy( object wParam=(null), object lParam=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (wParam)==(null) || wParam.GetType()!=typeof(string) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		CApp.This.ViewIndigator.ON( (CApp.This.ViewBusiness), CApp.This.Language.Get(TEXT.부서를_폐쇄하는_중입니다) );
//		LoveSignalHash.DepartmentDestroy( wParam as string );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 재고를 처분하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	void funcProductDispose( object wParam=(null), object lParam=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (wParam)==(null) || wParam.GetType()!=typeof(string) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		CApp.This.ViewIndigator.ON( (CApp.This.ViewBusiness), CApp.This.Language.Get(TEXT.재고를_처분하는_중입니다) );
//		LoveSignalHash.ProductDispose( wParam as string );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 컨트롤 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public virtual bool ONCONTROL( objControl control, CONTROL_ACTION Action, tagFocus focus=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (control)==(null) ) return false;
//		if( (focus)==(null) ) return false;		//(NULL)값을 허용함

		//---------------------------------------------------------------------------------------------------------------------------
		// 부서 패쇄
		//---------------------------------------------------------------------------------------------------------------------------
		if( (control)==Destroy() && (Action)==(CONTROL_ACTION.SELECT) )
		{
			CApp.This.Confirm.ON( Func.Script( CApp.This.Language.Get(TEXT.__부서를_폐쇄하시겠습니까), Name() ), (CONFIRM.YESNO), (funcDestroy), ID() );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		foreach( uiProduct product in Products() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// 상품 (PRODUCT)
			//-----------------------------------------------------------------------------------------------------------------------
			if( (control)==product.Control() && (Action)==(CONTROL_ACTION.SELECT) )
			{
				CApp.This.ViewProduct.ON( product.Get(), product.ID() );
				return true;
			}
			else
			//-----------------------------------------------------------------------------------------------------------------------
			// 재고 처분 (DISPOSE)
			//-----------------------------------------------------------------------------------------------------------------------
			if( (control)==product.Dispose() && (Action)==(CONTROL_ACTION.SELECT) )
			{
				CApp.This.Confirm.ON( Func.Script( CApp.This.Language.Get(TEXT.__의_재고를_처분하시겠습니까), product.Name() ), (CONFIRM.YESNO), (funcProductDispose), product.ID() );
				return true;
			}
			else
			//-----------------------------------------------------------------------------------------------------------------------
			// 그래프 (GRAPH)
			//-----------------------------------------------------------------------------------------------------------------------
			if( (control)==product.Graph().Control() && (Action)==(CONTROL_ACTION.SELECT) )
			{
				CApp.This.ViewProduct.ON( product.Get(), product.ID() );
				return true;
			}
#if UNITY_EDITOR
			else
			//-----------------------------------------------------------------------------------------------------------------------
			// 수요 (DEMAND)
			//-----------------------------------------------------------------------------------------------------------------------
			if( (control)==product.Demand() && (Action)==(CONTROL_ACTION.SELECT) )
			{
				Debug.Log( "수요: "+(product.data.nDemand)+" / 공급: "+(product.data.nSupply) );
				return true;
			}
			else
			//-----------------------------------------------------------------------------------------------------------------------
			// 공급 (SUPPLY)
			//-----------------------------------------------------------------------------------------------------------------------
			if( (control)==product.Supply() && (Action)==(CONTROL_ACTION.SELECT) )
			{
				Debug.Log( "수요: "+(product.data.nDemand)+" / 공급: "+(product.data.nSupply) );
				return true;
			}
#endif

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected _tagData Data()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (_data);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// ID를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public string ID()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().id);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 생산 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiIcon Make()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().make);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public float Fold()
	{
		float scroll = 0;

		if( IsFold() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			scroll = ( (Transform().sizeDelta.y) - (Data().foldHeight) ) / (2);
			if( Transform().GetSiblingIndex()==(0) )
			{
				(scroll) -= (60);
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(Transform().sizeDelta)		= new Vector2( (Transform().sizeDelta.x), (Data().foldHeight) );
			(Data().foldHeight)			= (0);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( true )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				foreach( Transform child in Data().Folds )
				{
					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
					if( (child)==Destroy().Transform() && !CApp.This.Business.IsRight(GetBusiness()) ) continue;
					if( !IsAllowInterfaceActive(child) ) continue;

					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
					child.gameObject.SetActive( true );

					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				Data().Folds.Clear();

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(Data().dropdown.localScale)	= new Vector3( (Data().dropdown.localScale.x), Mathf.Abs(Data().dropdown.localScale.y), (Data().dropdown.localScale.z) );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			return (scroll);
		}
		else
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			scroll = ( (Transform().sizeDelta.y) - (120) ) / (2);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(Data().foldHeight)		= (Transform().sizeDelta.y);
			(Transform().sizeDelta)	= new Vector2( (Transform().sizeDelta.x), (120) );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			Transform child = (null);
			for( int i=0; i<(Transform().childCount); i++ )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				(child)	= Transform().GetChild(i);
				if( Subject()!=(null) && (child)==Subject().Transform() ) continue;

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( (child)!=(null) )
				{
					child.gameObject.SetActive( false );
					Data().Folds.Add( child );
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(Data().dropdown.localScale) = new Vector3( (Data().dropdown.localScale.x), -Mathf.Abs(Data().dropdown.localScale.y), (Data().dropdown.localScale.z) );
		}

		return scroll;
	}

	public bool IsFold()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (Data().foldHeight)!=(0) )
		{
			return true;
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public RectTransform ProductLayer()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().productLayer);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 상품 정보를 등록하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiProduct Register( tagProductStatic productstatic, AppsParameter col )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (productstatic)==(null) ) return (null);
		if( (col)==(null) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		uiProduct icon = Find(col.Get("id"));
		if( (icon)==(null) )
		{
			(icon) = Create(productstatic);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (icon)!=(null) )
		{
			icon.Set( (productstatic), (col) );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		onRegister( (icon), (productstatic), (col) );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (icon);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 상품 정보를 등록하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public virtual void onRegister( uiProduct icon, tagProductStatic productstatic, AppsParameter col )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (icon)==(null) ) return;
		if( (productstatic)==(null) ) return;
		if( (col)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 상품 정보를 검색하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiProduct Find( string id )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Library.Is(id) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		foreach( uiProduct product in Products() )
		{
			if( product.ID()==(id) )
			{
				return (product);
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiProduct Create( tagProductStatic productstatic )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (productstatic)==(null) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		uiProduct icon = (Func.Create( ProductLayer(), (Resources.Load(PATH.UI_DEPARTMENT_PRODUCT_ITEM) as GameObject) ).GetComponent(typeof(uiProduct)) as uiProduct);
		if( (icon)==(null) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(icon.Transform().localPosition)	= new Vector3( (icon.Transform().localPosition.x), (icon.Transform().localPosition.y), (0) );
		(icon.Transform().anchoredPosition)	= new Vector2( (128), (-128)-(ProductLayer().sizeDelta.y)*(Products().Count) );
		(icon.Transform().anchorMin)		= new Vector2( (0), (icon.Transform().anchorMin.y) );
		(icon.Transform().anchorMax)		= new Vector2( (1), (icon.Transform().anchorMax.y) );
		(icon.Transform().offsetMin)		= new Vector2( (0), (icon.Transform().offsetMin.y) );
		(icon.Transform().offsetMax)		= new Vector2( (0), (icon.Transform().offsetMax.y) );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		icon.Set( (productstatic), (col) );

		//---------------------------------------------------------------------------------------------------------------------------
		// 사업체에 권한이 없을 경우, 재고 처분 버튼을 비활성화 함
		//---------------------------------------------------------------------------------------------------------------------------
		if( !CApp.This.Business.IsRight(GetBusiness()) )
		{
			if( icon.Dispose()!=(null) )
			{
				icon.Dispose().OFF();
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( ProductLayer()!=(null) )
		{
			if( IsFold() )
			{
				(Data().foldHeight)		+= (ProductLayer().sizeDelta.y);
			}
			else
			{
				(Transform().sizeDelta)	= new Vector2( (Transform().sizeDelta.x), (Transform().sizeDelta.y+ProductLayer().sizeDelta.y) );
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		Products().Add( icon );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (icon);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 상품 리스트를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public List<uiProduct> Products()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().Products);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 사업체 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagBusiness GetBusiness()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().business);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 상품을 검색하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiProduct FindProduct( string id )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (id)==(null) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		foreach( uiProduct product in Products() )
		{
			if( product.ID()==(id) )
			{
				return (product);
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 재고를 처분하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void ProductDispost( uiProduct product )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (product)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		Func.Destroy( product._GameObject() );
		Products().Remove( product );
		Refresh();

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( ProductLayer()!=(null) )
		{
			(Transform().sizeDelta)	= new Vector2( (Transform().sizeDelta.x), (Transform().sizeDelta.y-ProductLayer().sizeDelta.y) );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 부서 폐쇄 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public objControl Destroy()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().destroy);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// ID를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public string Name()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( Apps.Is(Get()) )
		{
			return CApp.This.Language.Get(Get().Name());
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void Refresh()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		int i = (0);
		foreach( uiProduct icon in Products() )
		{
			(icon.Transform().anchoredPosition)	= new Vector2( (icon.Transform().anchoredPosition.x), (-128)-(ProductLayer().sizeDelta.y)*(i) );
			(i) += (1);
		}
		
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 생산량 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public Text Output()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().output);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 인터페이스를 활성화 할 수 있는지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public virtual bool IsAllowInterfaceActive( Transform transform )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (transform)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return true;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 부서 정보를 처리하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public uiDepartmentInfo Info()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (Data().info);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
}

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------