using System.Collections;
using System.Collections.Generic;
using UnityEngine;

//-----------------------------------------------------------------------------------------------------------------------------------
// 이벤트 정보를 처리하기 위한 클래스
//-----------------------------------------------------------------------------------------------------------------------------------
public class CEventQuery : MonoBehaviour
{
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected CApp		app			= (null);
	protected CPlay		play		= (null);

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void OnEnable()
	{
		(this.app)		= (CApp.This);
		(this.play)		= (CPlay.This);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 이벤트를 활성화 하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ON( tagEvent Event )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (Event)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		(app.Event.data.currentEvent)	= (Event);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		switch( Event.Type )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// 대화 (CONVERSE)
			//-----------------------------------------------------------------------------------------------------------------------
			case (EVENT_TYPE.CONVERSE):
				Converse( Event );
				return true;

			//-----------------------------------------------------------------------------------------------------------------------
			// 릴리나 (RELENA)
			//-----------------------------------------------------------------------------------------------------------------------
			case (EVENT_TYPE.RELENA):
				Relena( Event );
				return true;

			//-----------------------------------------------------------------------------------------------------------------------
			// 함수 실행 (FUNCTION)
			//-----------------------------------------------------------------------------------------------------------------------
			case (EVENT_TYPE.FUNCTION):
				Function( Event );
				break;

			//-----------------------------------------------------------------------------------------------------------------------
			// MEMORIZE
			//-----------------------------------------------------------------------------------------------------------------------
			case (EVENT_TYPE.MEMORIZE):
				Memorize( Event );
				break;

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			default:
				Debug.Log(Event);
				break;

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return app.Event.ON();
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 대화 (CONVERSE)
	//-------------------------------------------------------------------------------------------------------------------------------
	void Converse( tagEvent Event )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (Event)==(null) ) return;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
//		app.ViewConverse.ON( (Event.charstatic), (Event.text) );

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 릴리나 (RELENA)
	//-------------------------------------------------------------------------------------------------------------------------------
	void Relena( tagEvent Event )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (Event)==(null) ) return;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
//		app.ViewConverse.Relena( Event.text );

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 함수 실행 (FUNCTION)
	//-------------------------------------------------------------------------------------------------------------------------------
	void Function( tagEvent Event )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (Event)==(null) ) return;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( Event.callback.Is() )
		{
			if( (Event.delay)>(0) )
			{
				app.MessageQueue.ON( (Event.callback.func), (Event.callback.wParam), (Event.callback.lParam), (Event.delay) );
			}
			else
			{
				Event.callback.Call();
			}
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// MEMORIZE
	//-------------------------------------------------------------------------------------------------------------------------------
	void Memorize( tagEvent Event )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (Event)==(null) ) return;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		Apps.Memorize( (Event.text), (Event.obj as string) );

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
}

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------