using UnityEngine;
using System.Collections;
using System.Collections.Generic;

//-----------------------------------------------------------------------------------------------------------------------------------
// 패널 정보를 처리하기 위한 클래스
//-----------------------------------------------------------------------------------------------------------------------------------
public class CPanel : MonoBehaviour
{
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	[System.Serializable]
	public class tagData
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		public List<objPanel>	Panels			= new List<objPanel>();

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		public ViewPanel		fullscreen		= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}
	public tagData		data		= new tagData();

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected CApp		app			= (null);
	protected CPlay		play		= (null);

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void OnEnable()
	{
		(this.app)		= (CApp.This);
		(this.play)		= (CPlay.This);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 움직임을 처리하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void _Action()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=0; i<(GetList().Count); i++ )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				panel.ReciveComponent().ONACTION();
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 패널 정보를 등록하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Register( objPanel panel )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (panel)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		GetList().Remove( panel );
		GetList().Add( panel );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 패널 정보를 삭제하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Release( objPanel panel )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (panel)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( panel.ReciveComponent()!=(null) )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (data.fullscreen)==panel.ReciveComponent() )
			{
//				app.History.InactivesRestore();
				(data.fullscreen)	= (null);
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			app.Canvas.Release( panel.ReciveComponent() );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		GetList().Remove( panel );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 패널을 맨 앞으로 가져오기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Fore( objPanel _panel, bool inflow=(true) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (_panel)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( _panel.IsPanel() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			bool onFore = (false);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			GetList().Remove( _panel );
			GetList().Add( _panel );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( _panel.Transform()!=null )
			{
				if( _panel.Transform().parent!=null && _panel.Transform().parent.childCount-_panel.Transform().GetSiblingIndex()>1 )
				{
					Func.SetAsLastSibling( _panel.Transform() );
					(onFore)	= (true);
				}
			}
			else
			{
				objPanel panel	= null;
				int End = GetList().Count;
				int n = 0;

				for( int i=0; i<End; i++ )
				{
					panel = GetList()[i];
					if( panel!=null && panel.IsPanel() )
					{
						panel.Transform().localPosition = new Vector3( panel.Transform().localPosition.x, panel.Transform().localPosition.y, n*-50f );
						n += 1;
					}
				}
			}

			if( onFore )
			{
				if( ( inflow || _panel.GetComponent(typeof(objForeBack))!=null ) && _panel.ReciveComponent()!=null  )
				{
					_panel.ReciveComponent().ONNAVIGATION();
					_panel.ReciveComponent().ONFORE();
				}
			}
		}
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 컨트롤 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONCONTROL( objControl control, CONTROL_ACTION Action, tagFocus focus=(null) )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (control)==(null) ) return false;
//		if( (focus)==(null) ) return false;		//(NULL)값을 허용함

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().Data()._Lock.Is() ) continue;

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( (panel.data.Close)==(control) && (Action)==(CONTROL_ACTION.SELECT) )
				{
					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
					control.Sound();

					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
					if( panel.ReciveComponent()!=(null) )
					{
						panel.ReciveComponent().ONCANCEL( CANCEL.CLOSE );
					}

					//---------------------------------------------------------------------------------------------------------------
					// -
					//---------------------------------------------------------------------------------------------------------------
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().ONCONTROL( (control), (Action), (focus) ) )
				{
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 오브젝트 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONCLICK( GameObject gameObject, CONTROL_ACTION Action )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (gameObject)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().Data()._Lock.Is() ) continue;

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().ONCLICK( (gameObject), (Action) ) )
				{
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 스위치 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONSWITCH( uiSwitch objswitch )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (objswitch)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().Data()._Lock.Is() ) continue;

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent().ONSWITCH(objswitch) )
				{
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 컨트롤 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONCANCEL( CANCEL Cancel )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( app.Confirm.Is() )
		{
			app.Confirm.Get().Panel().ReciveComponent().ONCANCEL(Cancel);
			return true;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONCANCEL(Cancel) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 마우스 왼쪽 버튼을 눌렀을 때 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONLBUTTONDOWN( Vector3 point, TOUCH_INDEX touchIndex )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsForeBack() )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent()!=(null) )
				{
					if( panel.ReciveComponent().ONLBUTTONDOWN( (point), (touchIndex) ) )
					{
						return true;
					}
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ForeBack().ONLBUTTONDOWN( (point), (touchIndex) ) )
				{
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				return true;	//FOREBACK은 이후 인터페이스를 차단하기 때문에 True를 반환함
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONLBUTTONDOWN( (point), (touchIndex) ) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 마우스 왼쪽 버튼을 뗬을 때 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONLBUTTONUP( Vector3 point, TOUCH_INDEX touchIndex )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsForeBack() )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ReciveComponent()!=(null) )
				{
					if( panel.ReciveComponent().ONLBUTTONUP( (point), (touchIndex) ) )
					{
						return true;
					}
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( panel.ForeBack().ONLBUTTONUP( (point), (touchIndex) ) )
				{
					return true;
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				return true;	//FOREBACK은 이후 인터페이스를 차단하기 때문에 True를 반환함
			}
			else
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
				if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
				{
					if( panel.ReciveComponent().ONLBUTTONUP( (point), (touchIndex) ) )
					{
						return true;
					}
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
				//-------------------------------------------------------------------------------------------------------------------
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 마우스 오른쪽 버튼을 눌렀을 때 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONRBUTTONDOWN( Vector3 point, TOUCH_INDEX touchIndex )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsForeBack() ) return true;

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONRBUTTONDOWN( (point), (touchIndex) ) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 마우스 오른쪽 버튼을 뗬을 때 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONRBUTTONUP( Vector3 point, TOUCH_INDEX touchIndex )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsForeBack() ) return true;

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONRBUTTONUP( (point), (touchIndex) ) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 드래그 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONDRAG( Vector3 point, TOUCH_INDEX touchIndex )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONDRAG( (point), (touchIndex) ) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 터치 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONPICK( object obj )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (obj)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONPICK(obj) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 엔터 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONSKIP()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int		End		= (GetList().Count);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in GetList() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONSKIP() )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 엔터 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONRETURN()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int		End		= (GetList().Count);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in GetList() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONRETURN() )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 삭제 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONDELETE()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int		End		= (GetList().Count);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in GetList() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONDELETE() )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsForeBack()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in GetList() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.ReciveComponent()!=(null) && panel.ReciveComponent().IsForeBack() )
			{
				return true;
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public objForeBack GetForeBack()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		objPanel	fore		= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in GetList() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( panel.ReciveComponent()!=(null) && panel.ReciveComponent().Canvas()!=(null) && panel.ReciveComponent().Canvas().ForeBack()!=(null) && panel.ReciveComponent().Canvas().ForeBack().Is() )
			{
				if( (fore)==(null) || panel.Depth()>fore.Depth() )
				{
					(fore)	= (panel);
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (fore)!=(null) )
		{
			return fore.ReciveComponent().Canvas().ForeBack();
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public List<objPanel> GetList()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return (data.Panels);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Active()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in app.Panel.GetList() )
		{
			if( panel.ReciveComponent()!=(null) )
			{
				panel.ReciveComponent().Active();
			}
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Inactive( ViewPanel exception=(null) )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
//		if( (exception)==(null) ) return;	//(NULL)값을 허용함

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel in app.Panel.GetList() )
		{
			if( panel.ReciveComponent()!=(null) && panel.ReciveComponent()!=(exception) )
			{
				panel.ReciveComponent().Inactive();
			}
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 풀 스크린을 설정하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Fullscreen( ViewPanel panel, tagHistory history=(null) )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (panel)==(null) ) return;
//		if( (history)==(null) ) return;		//(NULL)값을 허용함

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
//		if( (app.History.Historys().Count)<=(0) )
		{
			foreach( objPanel panel0 in GetList() )
			{
				//-------------------------------------------------------------------------------------------------------------------
				// -
		        //-------------------------------------------------------------------------------------------------------------------
				if( panel0.ReciveComponent()==(panel) ) continue;
				if( panel0.ReciveComponent()==(app.ViewIndigator) ) continue;
				if( panel0.ReciveComponent()==(app.ViewNavigation) ) continue;
				if( panel0.ReciveComponent()==(app.ViewBottom) ) continue;
				if( panel0.ReciveComponent()==(app.ViewFinance) ) continue;

				//-------------------------------------------------------------------------------------------------------------------
				// -
		        //-------------------------------------------------------------------------------------------------------------------
				if( panel0.ReciveComponent()!=(null) )
				{
					//---------------------------------------------------------------------------------------------------------------
					// -
			        //---------------------------------------------------------------------------------------------------------------
					if( !app.History.Inactives().Contains(panel0.ReciveComponent()) )
					{
						app.History.Inactives().Add(panel0.ReciveComponent());
					}

					//---------------------------------------------------------------------------------------------------------------
					// -
			        //---------------------------------------------------------------------------------------------------------------
					//Debug.Log( "풀스크린이 활성화될 경우 비활성화해야할 인터페이스 : "+(panel0), (panel0) );
					panel0.ReciveComponent().Inactive();

					//---------------------------------------------------------------------------------------------------------------
					// -
			        //---------------------------------------------------------------------------------------------------------------
				}

				//-------------------------------------------------------------------------------------------------------------------
				// -
		        //-------------------------------------------------------------------------------------------------------------------
			}
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (data.fullscreen)!=(null) && data.fullscreen.Is(true) )
		{
			if( (data.fullscreen)!=(panel) )
			{
//				app.History.ON(data.fullscreen);
				data.fullscreen.Inactive();
			}
		}
		else
		if( (data.fullscreen)!=(null) )
		{
			(data.fullscreen)	= (null);
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( !app.History.IsProcess() )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( app.History.GetFore()!=(null) && app.History.GetFore()!=(panel) )
			{
				app.History.GetFore().Inactive();
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			app.History.ON( (panel), (history) );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		app.ViewAlert.Clear();

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		(data.fullscreen)	= (panel);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 전체 화면으로 설정된 패널 객체를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public ViewPanel GetFullscreen()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return (data.fullscreen);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 전체 화면 모드의 패널이 작동 중인지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsFullscreen()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (data.fullscreen)!=(null) && data.fullscreen.Is() )
		{
			return true;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 풀스크린 인터페이스로 설정하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsFullscreen( ViewPanel panel )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (panel)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (data.fullscreen)==(panel) && panel.Is() )
		{
			return true;
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 컨트롤 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool ONINPUTEND( UnityEngine.UI.InputField inputField )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		if( (inputField)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		int			End		= (GetList().Count);

		objPanel	panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(End-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= (GetList()[i]);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (panel)!=(null) && panel.IsPanel() && panel.ReciveComponent()!=(null) )
			{
				if( panel.ReciveComponent().ONINPUTEND(inputField) )
				{
					return true;
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			if( (End)!=(GetList().Count) ) break;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public ViewPanel GetFore()
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		objPanel panel	= (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=(app.Panel.GetList().Count-1); i>=(0); i-- )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(panel)	= app.Panel.GetList()[i];
			if( panel.ReciveComponent()==(null) ) continue;
			if( panel.ForeBack()==(null) && !app.History.Is(panel.ReciveComponent()) ) continue;

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			return panel.ReciveComponent();
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 인터페이스를 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool Is( objPanel panel )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (panel)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		foreach( objPanel panel0 in GetList() )
		{
			if( (panel0)==(panel) )
			{
				return true;
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
}

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------