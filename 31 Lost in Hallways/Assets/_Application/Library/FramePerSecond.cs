using UnityEngine;
using UnityEngine.UI;
//using UnityEngine.Profiling;
using System.Collections;

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------
public class FramePerSecond : MonoBehaviour
{
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public Text				text			= (null);
	public static string	log				= (null);
	public static int		preMemorySize	= (0);

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void Awake()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(text)		= (GetComponentInChildren(typeof(Text)) as Text);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		Camera.onPostRender	+= OnPostRender;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
#if UNITY_PLAYER
		gameObject.SetActive(PlatformTest);

		if( !(PlatformTest) )
		{
			GameObject.Destroy(gameObject);
		}
#endif

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    public class tagFramePerSecond
    {
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
        float           lastTime            = (0);
        float           fs                  = (0);
        public float    framePerSecond      = (0);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
        public void Update()
        {
            if( (Time.time-lastTime)>(1) )
            {
                (framePerSecond)            = (fs);
                (fs)                        = (0);
                (lastTime)                  = (Time.time);
            }

            (fs)                            += (1);
        }

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
    };

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    public tagFramePerSecond	frameUpdate		= new tagFramePerSecond();
//  tagFramePerSecond	frameFixedUpdate	= new tagFramePerSecond();
//	tagFramePerSecond	framePostRender	 	= new tagFramePerSecond();

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void Update()
	{
        frameUpdate.Update();
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    void LateUpdate()
    {
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (CPlay.This)==(null) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
        string      text		= (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		int			Minute		= (int)((CPlay.This.Time)/(60));
		int			Second		= (((int)CPlay.This.Time)%(60));

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
#if PUSH_INFO
//		(text)	+= "Scene => "+CPlay.This.Scene+", View => "+CPlay.This.View+"\r\n";
		(text)	+= "Push => "+(CPlay.This.Push.p)+", "+(CPlay.This.Push.point)+"\r\n";
		(text)	+= "Context => "+(CPlay.This.Context.p)+", "+(CPlay.This.Context.point)+"\r\n";
		(text)	+= "Length => "+Func.Divide(Vector3.Distance((CPlay.This.Push.point), (CPlay.This.Context.point)), (CPlay.This.DragStartLength))+"\r\n";
//		(text)	+= "Drag Length => "+CPlay.This.drag_length+" / "+Func.GetDragDistance()+"\r\n";
#endif
		//(text)	+= "Characters => "+CApp.This.Character.data.Characters.Count+" unit\r\n";

		/*
		//---------------------------------------------------------------------------------------------------------------------------
		// FPS
		//---------------------------------------------------------------------------------------------------------------------------
		(text)	+= "FramePerSecond => "+frameUpdate.framePerSecond+" fs";
//		(text)	+= ", Time=> "+Func.LetterWord(Minute,2)+":"+Func.LetterWord(Second,2);
		(text)	+= ", Memory => "+Func.GetFileSize((int)UnityEngine.Profiling.Profiler.GetTotalAllocatedMemory()-(preMemorySize));
		(text)	+= "\r\n";
		*/

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		(text)	+= "FixedUpdate => "+frameFixedUpdate.framePerSecond+" fs\r\n";
//		(text)	+= "PostRender => "+framePostRender.framePerSecond+" fs\r\n";

		if( Library.Is(FramePerSecond.log) )
		{
			(text)	+= "Log => "+FramePerSecond.log+" fs\r\n";
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (this.text)!=(null) )
		{
			(this.text.text)	= (text);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
    }

	/*
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    void FixedUpdate()
    {
        frameFixedUpdate.Update();
    }
	*/

	/*
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void OnPostRender( Camera cam )
    {
        framePostRender.Update();
    }
	*/


	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public static void Log( string text )
	{
		(FramePerSecond.log)	+= (text)+"\r\n";
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
}

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------